<!-- 파일명: register.html -->
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>회원가입 - 싱싱수S</title>
  <link rel="icon" href="favicon.ico">
  <link href="https://fonts.googleapis.com/css2?family=Pretendard&display=swap" rel="stylesheet">
  <style>
    /* 헤더용 공통 스타일 */
    * { box-sizing: border-box; margin:0; padding:0; font-family:'Pretendard',sans-serif; }
    body { background:#f7f7f7; }
    header { display:flex; align-items:center; justify-content:space-between; padding:10px 20px; background:#fff; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .logo { font-size:1.2rem; font-weight:bold; }
    .admin-container { flex:1; text-align:center; }
    .admin-button { display:none; background:#dc3545; color:#fff; padding:6px 12px; border:none; border-radius:4px; cursor:pointer; }
    .auth-form { display:flex; gap:8px; margin-left:auto; }
    .auth-form input { padding:6px; border-radius:4px; border:1px solid #ccc; }
    .auth-form button { padding:6px 10px; border:none; background:#4CAF50; color:#fff; border-radius:4px; cursor:pointer; }
    .auth-info { display:flex; align-items:center; gap:8px; font-size:14px; margin-left:auto; }
    .logout-button { padding:6px 10px; border:none; background:#888; color:#fff; border-radius:4px; cursor:pointer; }
    /* 메인 컨텐츠 스타일 */
    main { display:flex; justify-content:center; align-items:center; height:calc(100vh - 58px); /* 헤더 높이 제외 */ }
    .register-form { background:#fff; padding:20px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); width:100%; max-width:400px; }
    .register-form h1 { margin-bottom:20px; font-size:1.5rem; text-align:center; }
    .register-form input, .register-form select, .register-form button {
      width:100%; padding:10px; margin-bottom:15px; border:1px solid #ccc; border-radius:4px; font-size:1rem;
    }
    .register-form button { background:#007BFF; color:#fff; border:none; cursor:pointer; }
    .register-form button:hover { background:#0056b3; }
    @media (max-width:600px) {
      header { flex-direction:column; align-items:flex-start; }
      .auth-form, .auth-info { width:100%; flex-wrap:wrap; }
      .auth-form input, .auth-form button, .auth-info span, .auth-info button { flex:1 1 100%; margin-bottom:8px; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">싱싱수S</div>
    <div class="admin-container">
      <button id="admin-btn" class="admin-button" onclick="goPage('admin')">관리자</button>
    </div>
    <div class="auth-form" id="auth-box">
      <input type="email" placeholder="Email(ID)" id="login-id">
      <input type="password" placeholder="Password" id="login-pw">
      <button onclick="login()">로그인</button>
      <button onclick="register()">회원가입</button>
    </div>
    <div class="auth-info" id="user-info" style="display:none;">
      <span id="user-name"></span> / <span id="user-group"></span>
      <button class="logout-button" onclick="logout()">로그아웃</button>
    </div>
  </header>

  <main>
    <form class="register-form" onsubmit="handleRegister(event)">
      <h1>회원가입</h1>
      <input type="email" id="reg-id" placeholder="Email 입력" required>
      <input type="password" id="reg-pw" placeholder="Password 입력" required>
      <select id="reg-group" required>
        <option value="" disabled selected>소속 목장 선택</option>
        <!-- ...목장 옵션... -->
      </select>
      <button type="submit">가입하기</button>
    </form>
  </main>

  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js';
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js';
    import { getFirestore, doc, setDoc, getDoc } from 'https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js';

    const firebaseConfig = { /* 요청하신 config */ };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // 공통 함수
    function renderUserInfo(profile) { /* header 정보 렌더 */ }
    async function login() { /* 로그인 */ }
    function register() { window.location.href='register.html'; }
    function goPage(p){ window.location.href=`${p}.html`; }
    function logout(){ signOut(auth).then(()=>window.location.reload()); }

    // 회원가입
    async function handleRegister(e){
      e.preventDefault();
      /* 회원가입 처리 후 redirect */
    }

    // auth 상태 유지
    onAuthStateChanged(auth, async user=>{
      if(user){
        const snap=await getDoc(doc(db,'users',user.uid));
        renderUserInfo(snap.data());
      } else {
        document.getElementById('auth-box').style.display='flex';
        document.getElementById('user-info').style.display='none';
      }
    });

    window.login=login;
    window.register=register;
    window.goPage=goPage;
    window.logout=logout;
    window.handleRegister=handleRegister;
  </script>
</body>
</html>
